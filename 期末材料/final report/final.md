---
title: 基于uniapp的校园社交系统
author:
  - 李坤(2223040529)
  - 李四(1912190319)
  - 王五(1912190320)
description: |
  我们开发了一个基于uniapp的校园社交系统，
  它前端采用uniapp，后端采用Python/FastAPI，
  实现了生活分享，校园设施评价等功能。
---

文档可以使用markdown编写，用[Pandoc](https://pandoc.org/)转成PDF、html或者word等格式:

~~~ bash
# Convert to PDF: 需要安装TeX Live
pandoc sample_docs.md -o sample_docs.pdf --pdf-engine=xelatex -V CJKmainfont="Noto Sans CJK SC"
# Convert to PDF: 需要安装typst
pandoc sample_docs.md -o sample_docs.pdf --pdf-engine=typst
# Convert to Word docx
pandoc sample_docs.md -o sample_docs.docx
# Convert to HTML
pandoc sample_docs.md -o sample_docs.html
~~~

文档不能使用外部材料（比如设计图放在网站，文档中贴一个链接），所有的材料必须包含在文档中。

# 一、项目介绍 [张三、李四、王五]

## 1.1 背景与问题陈述

介绍为什么要做这个项目，它解决了什么问题，实现了什么功能。描述传统课堂点名的痛点以及移动端解决方案的优势。

​	

## 1.2 项目目标与价值

明确项目要达到的具体目标，预期产生的价值和影响。

## 1.3 功能需求分析

介绍项目主要有哪些功能需求，需要实现什么样的功能。可以结合思维导图、用例图等进行说明。包括：
- 功能性需求
- 非功能性需求（性能、可用性、安全性等）
- 移动端特殊需求（离线支持、GPS定位等）

## 1.4 技术选型与架构概述

简要说明选择的技术栈及其理由，包括前端、后端、数据库等。

## 1.5 项目计划与团队分工

介绍大致的开发计划、里程碑以及每个人的分工。可以使用甘特图等工具展示。

# 二、需求分析与设计 [张三、王五]

## 2.1 用户画像与场景分析

详细分析目标用户群体（学生、教师、管理员），以及具体的使用场景。

## 2.2 界面原型设计

根据功能需求分析，分模块介绍每部分的原型设计。包括界面的具体细节、跳转关系以及实现说明等。

此部分应按照模块来进行组织，比如第一部分用户管理，其中包含了用户登录、注册、信息查看、修改等等，把这部分的界面设计及跳转关系统一放在一张图上。

除了设计图之外，应该用语言详细说明自己的设计理念，为什么要这么设计，有什么优缺点，实现的难度如何等等。

### 2.2.1 交互设计原则

说明移动端交互设计的特殊考虑，如手势操作、屏幕适配、响应式设计等。

### 2.2.2 用户体验设计

描述如何优化移动端用户体验，包括加载速度、操作便捷性、视觉设计等。

# 三、系统架构设计 [李坤]

## 3.1 整体架构设计

前端采用uniapp进行设计分为多个模块，一个是页面一个是组件，通过页面中调用组件实现一个组件的多次复用，另外还有一些是定义的页面公用的css样式和一些用于网络请求的JavaScript函数，优点是跨平台开发，节省人力，跨平台开发，节省人力，缺点是对性能要求高时可能不如原生开发流畅，复杂交互的场景可能需定制化开发；后端采用FastAPI，一共分为两层，第一层对应接口，负责接收数据并输出信息来调试，调用第二层的接口输出数据结果给前端，第二层则是负责查询数据库，进行数据校验，更改数据库，调用Redis等实际操作，优点是快速开发，语法清晰，支持异步，缺点是相对传统框架生态较小；API设计使用APIFox，根据不同类别的接口划分了用户管理、帖子管理、评论管理、校园评价、兼职招聘，优点是可视化接口管理，自动化文档，缺点是项目复杂时接口冗余问题需注意维护；缓存采用Redis，用于储存注册时候的验证码，优点是高速读写，支持多种数据结构，缺点是内存存储，成本高。

## 3.2 技术架构分层

### 3.2.1 表现层（前端）
前端包含五个模块，存储在五个不同的目录中，分别是common，用于存储一些固定的，不需要通过后端数据库访问的图片等资源，这些资源在很多的组件和页面中都可以调用；components，用于存放组件相关的代码文件，这些组件通常是在页面中被多次复用但是又有一些不同地方的，于是就把这些部分提取出来，并且把不同的地方设置为可调节的参数；node_modules作为插件存放的地方，在需要uniapp的各种插件的时候会将其下载到此目录下；utils用于存放在页面或者组件中会使用到的一些工具函数，在页面和组件中的JavaScript部分会先将这一目录下对应的文件导入来引用其中的工具函数；pages是最主要的部分，是前端的各个部分，用于整合各个资源，并把它完整准确的呈现出来。

这样设计可以让这个代码文件更加简洁清晰，并且减少代码之间的耦合度，因此，优点就是在bug检查与修复中可以更加高效。而缺点则是初期组件抽象需要时间。

### 3.2.2 业务逻辑层（后端）
后端采用 FastAPI 框架进行开发，主要负责提供前端所需的各类 API 接口，处理请求数据、业务逻辑判断、数据库交互等任务。整个后端分为几个模块。

1. 用户模块（/user）
    负责注册、登录、发送验证码、用户信息获取与修改等功能。

- 注册接口：接收用户名、邮箱、验证码、密码等参数，校验后插入数据库。
- 登录接口：校验用户名与密码，成功后生成 JWT Token 返回。
- 获取用户信息接口：从 JWT 中获取用户ID，查询数据库返回用户名、头像等信息。
- 更新头像接口：用户上传头像后存入静态目录，同时更新数据库路径。

2. 评审模块（/judge）
    用户可以查看评审、对评审点赞、评分、发表评论等。

- 获取所有评审：支持分页获取评审内容。

- 获取指定评审：传入评审ID，返回详细内容和评论列表。

- 点赞接口：记录用户点赞状态，避免重复点赞。

- 评分接口：用户提交评分，更新评审平均得分。

- 评论接口：用户提交评论，插入数据库。

3. 动态模块（/note）
   负责用户笔记的发布、查看、点赞、收藏、评论等功能。

- 发布笔记接口（note_add）：接收标题、内容、图片等参数，将笔记数据写入数据库，自动设置发布时间，初始化点赞数与收藏数为0。

- 获取所有笔记接口（get_all）：分页返回所有用户发布的笔记列表，同时查询每条笔记对应的作者名、头像、当前用户是否点赞/收藏、点赞/收藏数量等信息。

- 获取指定笔记接口（get_one）：传入笔记ID，返回该笔记的详细信息，包括作者信息、评论列表、当前用户的交互状态（是否点赞、是否收藏）等。

- 点赞接口（like）：用户对笔记执行点赞或取消点赞操作。重复请求自动切换点赞状态，避免重复点赞。

- 收藏接口（fav）：用户对笔记执行收藏或取消收藏操作。逻辑与点赞接口一致，避免重复收藏。

- 评论接口（comment_post）：用户在笔记下发表评论，记录评论者ID、评论时间和内容，插入评论表。

- 获取收藏笔记接口（get_collection）：返回当前用户收藏的所有笔记，包含作者名、头像、当前用户的交互状态等信息。

- 获取本人笔记接口（get_mynotes）：返回当前登录用户发布的所有笔记。

### 3.2.3 数据访问层
本系统的数据库使用 MySQL，主要表结构包括以下几类：

1. 用户信息表（UserModels）
    用于存储用户注册信息，包括用户名、密码、头像、创建时间等字段。
2. 笔记表（NoteModel）
    用于存储用户发布的动态笔记内容，包括标题、正文、作者ID、发布时间、图片路径等。
3. 点赞表（LikeModel）
    记录用户与笔记之间的点赞关系，包括用户ID、笔记ID、点赞时间等。
4. 收藏表（FavModel）
    记录用户收藏的笔记，与点赞表结构类似，用于收藏功能判断和展示。
5. 评论表（NoteCommentModel）
    记录用户对笔记的评论内容，包括用户ID、笔记ID、评论内容、时间等。

数据库表之间的主要关系包括：

- 用户（UserModels）与笔记（NoteModel）是一对多关系；
- 用户与点赞/收藏/评论之间是一对多关系；
- 点赞、收藏、评论通过笔记ID关联 NoteModel 表。

所有表均使用自增主键，数据结构简单明了，方便使用 ORM 工具进行映射。

二、数据访问模式

后端采用 SQLAlchemy ORM 实现数据访问，通过模型类定义数据库表结构，并以 Session 对象进行增删改查操作。数据访问主要分为以下模式：

1. 简单查询
    通过 `.filter_by()`、`.first()`、`.all()` 等方法快速查找符合条件的单条或多条记录。
2. 联表查询
    如笔记与用户表通过 `.join()` 联查，以便获取笔记作者信息或头像等。
3. 嵌套查询
    如点赞数、收藏数的统计通过子查询 `db.query(...).filter_by(...).count()` 实现。
4. 判断存在性
    如判断当前用户是否点赞/收藏，通过查询结果是否为 `None` 进行逻辑判断。

三、缓存策略

当前系统处于开发阶段，数据访问全部走数据库，尚未启用 Redis 等缓存中间件。但设计上保留了接口分层结构，后期可按需引入缓存机制以提高性能，例如：

- 用户登录状态和头像信息缓存（如 Redis）
- 热门笔记点赞数缓存，减轻数据库压力
- 查询结果短时间缓存，优化首页加载速度

# 四、API设计 [李坤、刘群]

## 4.1 API设计原则

介绍RESTful API设计原则、命名规范、版本控制策略等。

## 4.2 接口文档

分模块进行介绍，并通过APIfox或Swagger介绍API的设计理念，使用、测试方法等。用列表和文档对所有的API进行详细的列举和描述。

### 4.2.1 用户管理接口
### 4.2.2 课程管理接口  
### 4.2.3 点名相关接口
### 4.2.4 数据统计接口

## 4.3 接口安全设计

在后端接口的安全性设计中，系统主要从身份认证、权限控制与数据加密三个方面进行防护，确保数据传输过程的安全性和用户信息的私密性。

首先，身份认证采用 JWT（JSON Web Token）技术。用户登录成功后，后端生成一个加密的令牌并返回给前端，前端在后续所有请求中都需将该令牌放入请求头的 Authorization 字段中，后端中间件会在接收请求时自动解析并验证 JWT 的有效性，验证通过后才能放行请求。这一机制有效防止了用户伪造身份或越权访问行为。

在权限控制方面，后端通过解析 JWT 中的用户信息（如用户 id 或角色标识），对不同类型的用户（普通用户、管理员等）开放不同的接口访问权限。例如只有管理员才可访问某些管理类接口，而普通用户仅能进行个人信息修改、评价发布等操作。

数据加密方面，系统在处理用户密码时并不明文存储，而是使用哈希算法（如 bcrypt）对密码进行加密存储，确保即使数据库泄露，攻击者也无法直接获取原始密码。同时，跨域访问进行了严格限制，后端设置了 CORS 策略，仅允许特定前端地址进行访问请求，从源头防止了恶意跨站调用。

## 4.4 接口测试

为了保证系统接口的正确性与稳定性，项目采用了基于 pytest 的自动化测试框架，并结合 mock 技术进行测试隔离。对于每个核心接口（如注册、登录、获取评价、提交评论等），都编写了一个或多个测试用例，涵盖正常输入、边界情况与非法参数等多种场景，确保接口在各种情况下都能稳定运行或返回合理的错误信息。

由于接口逻辑中涉及数据库与 Redis 的读写操作，测试中通过 mock 替代真实数据库连接与缓存访问，模拟各种预期行为与异常情况，从而提高测试效率并避免真实数据污染。同时，测试脚本已集成至 GitHub CI 流水线中，每次代码提交或合并时会自动执行测试用例，及时发现回归错误与潜在问题。

整体测试策略结合单元测试与集成测试，既验证了各接口功能的正确性，也保障了模块间协作的稳定性，为项目的可靠性与后续维护提供了有力保障。

# 五、数据库设计 [李四]

## 5.1 数据模型设计

详细描述系统中需要持久化的数据以及需要缓存的数据等，根据数据的特点确定数据库方案（采用什么数据库及其原因）。

## 5.2 数据库架构

结合ER图、列表等对数据库中的数据进行详细描述，都有哪些表，保存了哪些数据，为什么要这么设计。

### 5.2.1 核心数据表设计
### 5.2.2 索引设计
### 5.2.3 数据库性能优化

## 5.3 数据访问层实现

详细描述所使用的数据库相关技术，比如ORM、连接池以及具体的使用方式。

## 5.4 数据同步与备份

移动端数据同步策略、数据备份与恢复方案。

# 六、前端实现 [李坤]

## 6.1 技术栈与开发环境

本项目前端采用 uni-app 作为主要技术框架，基于 Vue.js 开发语言，结合 HTML、CSS 和 JavaScript（ES6+）语法进行页面构建和逻辑实现。uni-app 的最大优势在于“一套代码、多端发布”，支持编译到微信小程序、H5 网页端、Android App、iOS App 等多个平台，在保证代码复用的同时，大幅降低多平台开发的工作量。

前端开发全部使用 HBuilderX 这一官方提供的集成开发环境进行，HBuilderX 提供了可视化界面、代码高亮、页面管理、实时预览和一键打包等功能，大大提升了开发效率。在实际开发过程中，开发者通过 HBuilderX 创建 uni-app 项目，利用 pages.json 文件配置项目的页面路由与导航，采用 Vue 单文件组件（.vue 文件）来组织页面逻辑、视图和样式，统一管理项目结构。样式部分采用标准 CSS 语法，也可以选择使用 uView 等开源 UI 框架以提升页面美观度和组件复用性。

网络通信方面，前端通过 uni-app 内置的 uni.request 接口与后端进行数据交互，支持 GET、POST 等常见请求方式，同时可统一封装请求方法，实现请求拦截、token 附加、错误处理等功能。为了管理页面间的状态共享，可以按需使用 Vuex 或 pinia 进行状态集中管理。

在调试与构建流程上，开发者通过 HBuilderX 实时预览功能在不同平台（微信小程序、H5、App）中预览效果，并根据实际平台需求进行适配和调整。微信小程序可通过微信开发者工具进行最终测试与发布，而 H5 页面可通过 HBuilderX 构建后部署至 Web 服务器。对于 Android 或 iOS 平台的 App，可以使用 HBuilderX 云打包功能，直接生成 APK 或 IPA 安装包，无需单独配置 Android Studio 或 Xcode 环境。

整体上，uni-app 框架配合 HBuilderX 开发工具，提供了一套高效、统一、低门槛的跨平台前端开发解决方案，适用于中小型应用项目的快速开发和部署。

## 6.2 核心功能模块实现

### 6.2.1 用户管理模块

用户管理模块主要实现了用户的登录、注册、修改密码等功能。在设计与开发过程中，重点考虑了系统的安全性、可用性与用户体验，结合现有技术与方案进行了多方面的权衡与优化。

在注册功能的早期版本中，用户仅需输入账号与密码即可完成注册，但这种方式容易被恶意用户利用进行批量注册，同时也不利于后续的身份找回与验证。因此在当前版本中，引入了注册邮箱机制，用户需填写邮箱并接收验证码。验证码由后端随机生成，并存入 Redis 数据库中设置短时限有效期（如 5 分钟），同时通过邮件发送至用户邮箱。前端用户输入验证码后由后端进行验证，验证通过后方可正式注册账号。该机制有效防止了恶意注册行为，并为密码找回等功能打下基础。

登录功能方面，初始实现中用户登录后会在页面中暴露用户 id，此做法存在严重的安全隐患，攻击者可能通过篡改页面参数访问或操作其他用户的信息。为此，在优化后的版本中，系统采用 JWT（JSON Web Token）技术实现身份验证机制。用户登录成功后，后端会为其生成一个加密的校验令牌（token），该 token 中包含用户唯一标识（如 id）及签名信息，并返回至前端。前端在后续的所有请求中需将该 token 放置于请求头中（通常为 Authorization 字段），后端在接收请求时会验证该 token 的有效性，并解析出用户身份进行操作。这种方式有效防止了用户身份被伪造或篡改，提高了系统的整体安全性。

密码修改功能也采用了类似的校验流程，只有在用户已登录并身份验证通过的前提下，才允许进行密码修改操作，防止未授权用户篡改他人密码。而且为了给密码多一层安全保障，对密码进行了一轮的加密操作才存储进数据库中。

综合来看，用户管理模块采用邮箱验证码+Redis实现注册验证，JWT 实现登录状态与身份校验，这种设计兼顾了安全性与用户体验，防止了恶意攻击、信息泄露等风险问题。同时，相关功能在界面上也做了清晰的引导与反馈，确保用户能够顺利操作。

![image-20250607222042516](.\image-20250607222042516.png)

![image-20250607222706017](.\image-20250607222706017.png)

### 6.2.2 动态管理模块

这部分主要讲点名功能的具体实现方案，可以通过用例图、流程图等来辅助说明。并通过截图来展示效果。
![image-20250607222706017](.\Snipaste_2025-06-07_23-20-33.jpg)

登陆之后会收到令牌，携带着令牌就可以查看各种帖子是否已经被自己点赞收藏，也可以发表评论与帖子。通过向后端直接请求这个帖子的详细信息，后端就会根据令牌查出id号，并查出关联的是否收藏等信息。

在发布动态的界面，也可以通过点击AI帮写功能，向文心一言请求以自己的标题为标题来撰写动态文案，让AI生成功能来辅助自己撰写文案。

![image-20250607233552916](.\Snipaste_2025-06-07_23-32-05.jpg)



### 6.2.3 校园评价模块

校园评价模块主要用于对学校内不同类型的设施（如教学楼、食堂、图书馆、宿舍等）进行分类展示、评分与评论，实现用户间的交流与反馈，辅助后续设施优化与改进建议。在该模块的设计与实现中，采用了“标签分类”技术以及评价聚合与展示机制，以提升用户体验与数据利用价值。

实现过程中，前端使用 uni-app 框架开发，通过设置 type 标签来标识每一条评价所对应的设施类别，后端数据库中则设计了相应的字段用于存储类别信息。用户在发布评价时需要选择所属类别，系统将自动对数据进行归类，展示页面中则可以通过类别筛选功能对不同类型设施的评价进行查看。这样的分类机制能够有效组织评价数据，使用户能够快速定位到感兴趣的部分，也便于进行同类设施之间的横向比较与排名。

评分系统方面，每条评价包含用户提交的分数，后端在接收评价数据后会自动统计每个类别下每个具体设施的评分总数与平均值，从而生成排行榜展示在首页或分类页中。这样可以清晰地反映出用户对各设施的满意程度，具有一定的参考与引导作用。

该模块的主要技术实现包括：
- 前端采用 uni-app 框架进行跨平台开发，结合页面中的 tab 选项卡、下拉筛选等组件实现分类与切换功能；
- 后端采用 FastAPI 框架实现 RESTful 接口服务，利用 ORM 对象关系映射将评价数据写入数据库；
- 数据库设计中对设施类别与评分数据建立了关联关系，便于查询和聚合统计；
- 前后端交互中统一使用 JWT 令牌进行身份认证，防止匿名刷分与恶意评价；
- 排名功能采用简单的聚合排序算法，定期更新评分排名，提高数据实时性。

优点方面，该模块结构清晰、逻辑明确，通过标签分类使界面更加简洁，提升了数据的组织性与可读性，同时评价聚合和排序功能也增强了平台的参考价值。但在实现过程中也存在一定难点，例如评分的刷票防范、评价内容的规范管理、排行榜数据的实时更新等问题，都需要结合权限控制、后台审核、缓存机制等手段进行解决。

此外，界面设计上提供了图文混排的展示方式，用户不仅可以评分，还可以附带文字评价，使得评价内容更加丰富直观。下方截图展示了分类浏览页面、评价发布页面以及设施排行榜界面，能够体现整体的模块实现效果与用户交互流程。

![image](.\Snipaste_2025-06-07_23-32-05.jpg)

![image](.\Snipaste_2025-06-07_23-43-38.jpg)

## 6.3 性能优化

在系统开发过程中，为了提升用户体验与应用整体性能，前端部分针对加载速度、网络请求以及界面响应进行了多方面的优化设计。

在网络请求方面，使用了 JavaScript 中的 async/await 异步编程机制，实现异步任务的顺序控制，确保界面在执行长耗时任务时不会出现卡顿或无响应的情况。特别是在调用 AI 接口、获取远程资源等操作中，这类请求往往存在不确定的延迟时间。为了缓解用户等待过程中的不适感，前端在发起这些请求时配合使用 `uni.showLoading` 显示一个加载提示，提示用户系统正在处理任务，当请求完成后再通过 `uni.hideLoading` 隐藏加载框，从而给用户提供明确的操作反馈。

此外，为了避免重复加载相同数据导致的不必要请求，系统在部分页面实现了缓存机制。对于不频繁变化的数据，例如设施分类信息、静态评分排名等内容，可以在首次加载时存入本地（如使用 `uni.setStorageSync`），后续访问时优先读取缓存，再决定是否进行更新请求，从而有效减少网络负担，加快页面加载速度。

在内存管理方面，系统通过合理的页面跳转与组件卸载策略，避免长时间驻留页面导致的内存占用增长。例如，在切换页面时主动销毁无用组件或重置数据状态，防止数据残留或引用泄露，从而保持系统运行的稳定性和流畅度。

综上所述，通过 async/await 控制异步逻辑、配合 loading 提示优化用户等待体验、使用本地缓存减少重复请求以及合理的页面资源释放管理，有效提升了系统的加载速度和运行性能，为用户提供了更加流畅、稳定的使用体验。

# 七、后端实现 [李坤]

## 7.1 技术栈与架构

本项目的后端部分采用 Python 的 FastAPI 框架进行开发，结合 Uvicorn 作为高性能 ASGI 服务器，搭配 SQLAlchemy 进行数据库 ORM 映射，并使用 Redis 作为缓存与临时数据存储方案，同时通过 JWT 实现用户身份认证。整体架构简洁清晰，模块解耦性强，具有良好的可扩展性与维护性。

选择 FastAPI 的主要原因在于其支持异步编程（async/await），能够轻松应对高并发请求场景，同时具有非常高的性能表现，接近 Node.js 和 Go 等语言的水平。此外，FastAPI 内置了强大的自动文档生成功能，开发者只需通过类型注解和 Pydantic 模型定义接口参数，即可自动生成符合 OpenAPI 标准的接口文档，极大提升了开发效率与调试便利性。

项目中，FastAPI 负责提供 RESTful 风格的接口，处理用户登录注册、评价提交、数据查询等业务逻辑，并通过依赖注入机制简化参数传递与权限控制。SQLAlchemy 则用于数据库操作，支持模型定义、自动建表、数据增删查改等操作，有效提升数据库交互的安全性和可维护性。Redis 用于缓存邮箱验证码、用户会话等临时数据，配合定时失效机制确保数据的时效性与安全性。而在用户认证方面，后端采用 JWT 技术为用户生成令牌（token），通过请求头携带令牌来识别用户身份并进行权限验证，确保系统接口的安全访问。

整体来看，该后端技术栈在开发效率、运行性能和安全控制之间实现了较好的平衡，适用于当前项目中中小规模数据处理与用户交互需求，也为后期功能扩展和多端支持提供了良好的基础。

## 7.2 核心业务模块实现

### 7.2.1 用户认证与授权

首先，身份认证采用 JWT（JSON Web Token）技术。用户登录成功后，后端生成一个加密的令牌并返回给前端，前端在后续所有请求中都需将该令牌放入请求头的 Authorization 字段中，后端中间件会在接收请求时自动解析并验证 JWT 的有效性，验证通过后才能放行请求。这一机制有效防止了用户伪造身份或越权访问行为。

### 7.2.2 帖子管理服务

在帖子管理服务中，用户可以查看他人发布的动态内容，并进行点赞与收藏操作。系统在前端发起获取帖子信息的请求时，会在请求头中携带用户的 JWT 令牌，后端在接收到请求后会解析令牌提取用户的 id，再根据该用户 id 与帖子 id 联合查询点赞表与收藏表，判断该用户是否已经对该帖子进行过点赞或收藏。如果查询结果存在，则将对应状态标记为 True，并将其返回前端，前端据此调整页面显示效果，例如将点赞或收藏图标的颜色由半透明变为实色，提供直观的交互反馈。

在用户进行点赞或收藏操作时，系统会首先检查数据库中是否已有该用户对该帖子的对应记录。如果没有记录，则执行插入操作，表示新增点赞或收藏；若已存在，则说明用户希望取消操作，此时执行删除操作，保持前后端状态一致，确保操作具有幂等性。

在发布动态方面，用户最多可选择九张图片上传至系统。前端会将图片文件发送至后端，后端将图片编码后存储至对象存储服务器（如本地或云端），并使用 UUID 进行唯一命名，避免文件名冲突。上传成功后，系统将生成的图片链接地址存入数据库，与该动态一并存储。为了丰富动态内容，系统还引入了 AI 文本生成功能，用户在填写标题时可以点击“AI帮写”按钮，系统会调用文心一言大模型，根据标题智能生成对应内容，提高用户创作效率与内容质量。

### 7.2.3 打分评价逻辑

在校园评价功能中，用户可通过点击星星的方式进行评分，评分数据提交至后端。后端收到评分请求后会首先判断该用户是否已对该目标进行过评分。如果是首次评分，系统根据“（当前平均分 × 当前人数 + 新评分）÷（当前人数 + 1）”的公式更新平均分与总评分人数；若是重复评分，则会读取原有评分，先用平均分与人数计算出总评分值，将新评分替换旧评分所产生的差值加到总评分上，最后再除以总人数，从而得出新的平均分。这样既避免了重复计算所有评分数据，也能快速更新平均值。

为进一步提升效率，系统不会每次都重新统计评分记录的条数，而是将评分人数单独维护在数据库字段中，通过自增或更新方式管理，从而大幅减少数据库读取负担，提高系统响应速度。

## 7.3 中间件与工具集成

### 7.3.1 数据库中间件

系统使用 SQLAlchemy 作为 ORM 框架，封装了对数据库表的操作逻辑。在 `models` 目录下，定义了与数据库中各表结构对应的 Python 类，每个类的属性对应数据表中的字段。通过 SQLAlchemy，可方便地进行建表、查询、插入、更新等操作，减少原始 SQL 的编写，提高代码可读性与可维护性。

### 7.3.2 缓存机制（Redis等）
在用户注册功能中，为防止恶意注册与增强验证码校验机制，系统引入了 Redis 缓存作为临时数据存储。用户提交注册请求后，系统生成一个随机验证码，并通过后端将该验证码发送至用户提供的邮箱地址，同时将验证码以用户邮箱为 key 存入 Redis，设置有效期为五分钟。在用户输入验证码并提交注册信息时，后端会从 Redis 中读取对应验证码并与用户输入进行比对，验证成功后完成注册流程并删除 Redis 中对应记录，确保验证码的一次性与时效性，有效提升系统安全性与用户体验。



# 八、移动计算特色功能 [李坤]

## 8.1 AI集成应用

### 8.1.1 智能AI帮写

在系统的动态发布模块中，为提升用户内容创作效率与质量，引入了 AI 文本生成能力，集成了百度的文心一言大语言模型。当用户在发布动态时填写了标题内容后，可以点击“AI帮写”按钮，系统会将用户填写的标题作为提示词，通过后端调用文心一言的接口，生成与标题相关的文本内容。

这一过程通过异步请求完成，前端将标题内容通过接口发送至后端，后端使用文心一言的 API 进行调用，并将返回的生成文本发送回前端展示在内容输入框中，用户可以根据自动生成的内容进行修改或直接使用。

该功能在提升内容质量的同时也大大降低了用户的输入成本，特别适用于没有明确写作思路或希望快速完成发布任务的用户。通过自然语言生成模型生成的内容通常语义连贯、主题贴合，能够为用户提供有价值的参考文本。

在交互体验上，为了让用户知晓AI帮写功能正在允许，uni.showLoading进行反馈，在API调用结束之后，就让其消失，之后AI帮写的功能就会直接出现在内容框中。

技术上，该功能的实现重点包括提示词设计、接口调用稳定性、内容回显的异步处理等，同时需要注意生成内容的合规性与安全性，避免不当信息的出现。整体而言，该功能融合了 AI 与传统应用逻辑，是本系统中的一项智能亮点应用。

# 九、安全设计 [李坤]

## 9.1 安全威胁分析

分析系统面临的主要安全威胁和风险。

网站并没有对访问的IP进行限制，也没有爬虫机器人协议robot.txt，如果遭受DDoS攻击或者大量的爬虫，可能会引起服务器的崩溃。

## 9.2 安全防护措施

### 9.2.1 身份认证与授权

系统采用 JWT（JSON Web Token）进行身份认证和权限控制。用户登录成功后，后端生成带有加密签名的令牌（包含用户 ID、过期时间等信息）并返回给前端。前端在之后的每一次请求中，将该令牌放入请求头的 Authorization 字段中，后端统一通过工具函数对令牌进行解码与验证，自动获取用户 ID，并基于此进行身份识别和权限判定，从而确保系统接口只能由合法用户访问。

![image](./Snipaste_2025-06-08_14-37-10.jpg)

### 9.2.2 数据加密

在用户密码管理方面，系统采用哈希算法对密码进行加密存储。用户注册或修改密码时，后端使用不可逆的哈希函数（如 SHA-256 或 bcrypt）将明文密码加密后写入数据库。在用户登录时，将传入的密码同样加密后与数据库中的加密值进行对比，确保密码在传输和存储过程中不以明文形式暴露，有效防止数据库泄漏时用户隐私被破解。

![image](./Snipaste_2025-06-08_14-37-49.jpg)

### 9.2.3 网络安全

为了保障系统在网络层的安全性，后端对跨域资源共享（CORS）策略进行了严格配置，仅允许来自前端正式部署服务器的请求访问后端接口，拒绝任何未授权源的跨域请求，从而有效防止恶意网站发起的跨域攻击（如CSRF）。此外，在接口返回中避免暴露服务器结构与敏感信息，减少被攻击的可能性。对于敏感接口还可结合Referer校验与Token机制进行双重保护，提升系统整体网络安全水平。

![image](./Snipaste_2025-06-08_14-38-29.jpg)

## 9.3 隐私保护

系统在设计过程中充分考虑了用户隐私保护的需求，尽量减少对用户个人信息的采集，仅在注册时要求用户提供一个邮箱，用于身份验证、验证码接收与找回密码功能。同时，该邮箱信息不向其他用户公开，严格限制访问权限，防止用户信息泄露。此外，系统在与外部 API（如邮箱发送、AI生成等）交互时，也会注意屏蔽用户敏感数据，避免隐私泄露风险，从合规性角度最大程度保障用户信息安全。

# 十、系统测试 [李坤]

## 10.1 测试策略与计划

本系统采用前后端分离架构，针对不同模块制定了差异化的测试方案：

- **前端测试**：使用影刀 RPA（机器人流程自动化）技术模拟用户行为，通过图像识别和组件定位，实现对页面按钮点击、输入框填写、导航跳转等功能的自动化测试。覆盖系统主要交互流程，验证交互逻辑与页面响应正确性。
- **后端测试**：使用 `pytest` 框架结合 `mock` 技术对后端接口进行单元测试。对于依赖数据库、缓存或外部服务的函数，使用 `mock` 替代真实调用，确保测试的独立性与可重复性。测试用例覆盖所有关键接口，并集成于 CI 流程中实现自动执行。

## 10.2 单元测试

后端共设计并实现了 22 个单元测试用例，覆盖了包括用户注册、登录、帖子管理、评分逻辑、验证码验证、AI生成调用等所有接口逻辑。覆盖率达到 100%。测试方式采用：

- 输入边界数据与非法数据，检查接口处理逻辑健壮性；
- 使用 mock 替代 Redis、数据库等依赖，模拟多种业务分支；
- 对返回状态码与返回内容进行断言验证。

## 10.3 集成测试

系统集成测试包含两个部分：

- **前后端集成测试**：通过影刀 RPA 进行端到端自动化测试，验证用户从登录到发帖、查看、评分的完整流程，测试覆盖率超过 70%。
- **第三方服务测试**：包括 AI 接口（文心一言）、邮件验证码发送服务、Redis 缓存等。使用 mock 对 AI 与邮箱服务进行模拟，确保测试环境稳定；Redis 在测试时自动初始化并设置过期策略，避免数据污染。

![image](./Snipaste_2025-06-08_15-22-37.jpg)

## 10.6 测试部署与 CI/CD

本项目已集成 GitHub Actions 实现 CI/CD 流程：

1. 开发者提交代码后，GitHub Actions 自动拉取项目代码；
2. 安装依赖：读取 `requirements.txt` 安装指定版本的 Python 包；
3. 环境准备：因 GitHub Actions 的文件结构不固定，使用脚本自动扫描并记录接口与测试路径，统一变量化管理；
4. 执行测试：调用 `pytest` 自动运行所有测试用例，输出测试报告；
5. 反馈机制：测试失败则中断部署流程，并通过邮件或通知机制提示开发者；测试通过则触发下一步构建或部署操作。

该自动化测试与部署流程确保了每次提交的代码都经过严格验证，提高了系统的稳定性和可维护性。

![image](./Snipaste_2025-06-08_15-21-17.jpg)

# 十一、云计算服务应用 [王五]

## 11.1 云服务选型

介绍选择的云平台（阿里云、腾讯云、AWS等）及其理由。

使用百度云的文心一言进行人工智能大语言模型计算

## 11.2 云服务架构

### 11.2.2 存储服务（OSS、数据库等）

在后台服务器中部署了对象存储服务（OSS）用于图片的存储。前端上传的图片会被编码为Base64格式后传输至后端，后端将其存入OSS的 Bucket 中，每张图片以 UUID 命名，确保文件名唯一性并便于管理。数据库方面，使用本地服务器中部署的 MySQL 数据库作为核心数据存储组件，负责管理用户信息、帖子内容、评分数据等结构化信息。通过 SQLAlchemy ORM 映射管理数据库表结构与数据交互逻辑，确保了数据访问的安全性与可维护性。

### 11.2.3 网络服务

项目通过 Uvicorn 作为 ASGI 服务器将后端 FastAPI 服务与互联网连接。前端应用通过 HTTP 协议访问后端 API 接口，前后端通信通过标准的 JSON 数据格式完成，所有请求均需携带 JWT 鉴权令牌。后端配置了跨域策略，仅允许前端部署服务器进行接口访问，确保网络通信的安全与稳定。

## 11.3 云原生应用

项目引入了百度的“文心一言”大模型服务作为 AI 帮写模块的支撑，用户在发布帖子时可通过点击“AI帮写”按钮，将标题发送至后端，由后端调用“文心一言”的生成接口生成符合语义的正文内容返回给前端，提升用户创作效率。该模块基于云服务部署，接口调用稳定、延迟低，并具备良好的可扩展性，是系统向云原生方向演进的重要尝试。

# 十二、系统部署与运维 [王五]

## 12.1 部署架构

采用了什么样的部署方案（Docker、虚拟机、云平台），具体的步骤和使用方法。

## 12.2 持续集成与部署

自动化部署流程、版本管理、回滚策略等。

## 12.3 可观测性与监控

### 12.3.1 系统监控
### 12.3.2 应用性能监控（APM）
### 12.3.3 日志收集与分析
### 12.3.4 报警机制

## 12.4 运维管理

系统维护、故障处理、性能调优等运维实践。

# 十三、性能优化 [李四、王五]

## 13.1 前端性能优化

### 13.1.1 页面加载优化
### 13.1.2 资源优化
### 13.1.3 渲染性能优化

## 13.2 后端性能优化

### 13.2.1 数据库优化
### 13.2.2 缓存策略
### 13.2.3 并发处理优化

## 13.3 网络优化

### 13.3.1 CDN应用
### 13.3.2 HTTP优化
### 13.3.3 数据压缩

# 十四、功能展示 [张三、李四、王五]

## 14.1 系统演示

基本的功能展示，可以用视频来展示。如果贴图，请尽量将相同模块的图拼接在一起以减少空间占用。

## 14.2 用户体验测试

真实用户使用反馈、用户体验评估等。

## 14.3 性能测试结果

系统在不同负载下的性能表现。

# 十五、项目管理与协作 [张三、李四、王五]

## 15.1 开发流程

介绍团队采用的开发方法论（敏捷、Scrum等）、工作流程。

## 15.2 协作工具

版本控制、项目管理、团队协作工具的使用。

## 15.3 质量保证

代码review、测试流程、质量控制措施。

# 十六、成果与交付物 [张三、李四、王五]

## 16.1 项目交付清单

- 前端代码: wx_class项目
- 后端代码: class_backend项目  
- 数据库脚本: database/目录
- API文档: docs/api/目录
- 原型设计文件: docs/design/目录
- 项目演示视频: docs/videos/目录
- 用户手册: docs/user_manual.md
- 部署文档: docs/deployment.md
- 测试报告: docs/test_report.md

## 16.2 知识产权与开源

项目的知识产权归属、是否开源及开源协议选择。

# 十七、总结与展望 [张三、李四、王五]

## 17.1 项目总结

项目的完成情况、达成的目标、主要成果等。

## 17.2 技术收获

团队成员的技术收获、能力提升、经验总结。

## 17.3 问题与反思

项目过程中遇到的问题、解决方案、经验教训。

## 17.4 未来展望

下一步的计划、功能扩展、技术演进方向。

## 17.5 商业化前景

项目的商业价值、市场前景、可能的商业模式。

# 参考文献

系统所参考的文献、技术文档、开源项目等，按照学术规范格式编写：

[1] 微信小程序开发文档. https://developers.weixin.qq.com/miniprogram/dev/framework/

[2] Flask Web开发框架. https://flask.palletsprojects.com/

[3] React Native官方文档. https://reactnative.dev/

[4] 移动应用开发最佳实践. 人民邮电出版社, 2023.

[5] 云原生应用架构指南. 机械工业出版社, 2022.

---

**附录**

## 附录A：详细API文档
## 附录B：数据库表结构
## 附录C：部署脚本
## 附录D：测试用例清单
